Obsidian 同步服务是一项能让你在各设备间同步笔记的收费服务。

### Obsidian 同步服务的工作原理

Obsidian 同步服务的工作原理非常简单：当你将多个本地库连接到同一个远程库时，任意一个本地库的修改都会通过远程库扩散到其他本地库中，从而实现不同本地库内容的一致。当然，你也可以通过设置忽略一些改动。

### 功能

目前，Obsidian 同步服务拥有以下功能：

- 端到端加密
- 整合到 Obsidian 客户端中的版本历史
- 回收站（查看云端的删除历史，并可撤销删除）
- 同步配置文件（同步主要设置、主题、CSS 代码片段、第三方插件设置等内容）
- 选择性同步
	- 忽略指定文件夹
	- 选择需要同步的附件类型（图片文件、视频文件、音频文件、PDF 以及其他不被 Obsidian 支持的文件类型）
- 多个远程库间的无缝切换

未来，Obsidian 同步服务还会有：

- 库分享功能

### 打开同步插件

在 v0.9.21 或更高版本的 Obsidian 中，你可以在 `设置` → `核心插件` 中打开同步插件。

### 设置远程库

需要注意的是，我们并不推荐第三方同步服务与 Obsidian 的同步功能一起使用。见[[#第三方同步服务]]部分。

使用 Obsidian 同步服务的第一步是创建一个远程库。远程库将以加密方式将你本地的笔记数据储存在云端。

创建远程库的方法很简单，`设置` → `同步` → `选择远程库` → `选择` → `新建远程库` 即可。

当你创建好了远程库后，你可以立即将当前的本地库与该远程库连接（点击远程库后的 `连接` 按钮即可）。

连接好远程库后，Obsidian 会询问你是否立即开始同步。当然，在同步前，你还可以配置需要忽略的文件夹。

##### 设置加密密码

默认情况下，你需要为自己的远程库设置一个加密密码。这个密码将用来对你的笔记数据进行加密、解密。因此它非常重要。

当你新建远程库时，Obsidian 会要求你提供加密密码。==如果你忘记或遗失了这个密码，那么你储存在云端的笔记数据将永远无法解密、使用。我们无法帮你解密这些数据。==但即便这样，你本地的笔记数据也不会受影响。

你也可以选择关闭 `自定义端到端加密密码功能`，这样你就没必要记住密码了。我们会采用相应的加密方案来保证你笔记数据的安全。这是一个方便且安全的选择。

### 确认同步状态

连接远程库后，你可以通过查看底部状态栏的图标来确认同步状态。如果想了解更多信息，请将鼠标悬停在同步状态图标上。

小技巧：点击同步状态图标可以快速打开同步设置

### 版本历史

编辑笔记时，同步服务会每十秒储存一次笔记，从而形成笔记的版本历史。==同步服务仅记录笔记的版本历史，库中的附件则不会生效。==

在文件列表中选中某个文件，点击右键，你就可以查看该笔记的版本历史。当然，你也可以在笔记面板右上角的 `更多选项` 菜单中查看当前笔记的版本历史。

打开版本历史窗口，在左边的列表中选中某个版本后，点击 `恢复此版本` 按钮，你就可以将当前笔记恢复到该版本。

### 删除文件

当你删除了某个文件后，你可以在 `设置` → `同步` → `已删除文件` → `查看` 中找到它。

点击删除文件可以打开该文件的版本历史。此时，你可以选择是否将文件恢复到之前的某个版本。

### 选择性同步

同步时，你可以排除一些文件夹以及特定类型的文件。==需要注意的是，当你改变选择性同步的设置后，这种改变仅影响未来的同步，已同步的文件则不会被影响。也就是说，即便你想忽略特定类型的文件，该类型已同步的文件也不会被 Obsidian 删除。所以，请在同步前好好思考这个设置。==

##### 排除文件夹

要让某个文件夹不被同步，你需要在 `设置` → `同步` → `需要排除的文件夹` → `管理` 中进行设置。

设置好后，无论你对这些文件夹进行怎样的修改，Obsidian 都不会将修改上传、下载。

#### 同步的文件类型

你可以在 `设置` → `同步` → `选择性同步` 中选择你想同步的文件类型（图片、音频、视频、PDF 以及其他不被 Obsidian 支持的文件类型）。

### 同步配置文件

除了笔记和附间，Obsidian 还允许你同步库的配置文件。这些配置文件包括：

- Obsidian 的主要设置，比如编辑器、文件与链接等方面的设置。
- 外观设置，比如基础颜色、当前应用的主题、开启的 CSS 代码片段等设置信息。
- 主题与 CSS 代码片段，即那些保存在库中的主题和 CSS 代码片段文件。
- 快捷键。
- 核心插件的启用情况，即核心插件的开启信息。
- 核心插件的设置信息。
- 第三方插件启用情况，即第三方插件开启信息。
- 已下载、安装的第三方插件，包括插件本身及其设置文件。

你可以选择同步哪些配置文件，从而让你在不同设备上都有最好的使用体验。

需要注意的是，同步配置文件不意味着其他设备上的 Obsidian 能自动应用最新的配置文件——配置文件只有重启 Obsidian、或重新加载当前库才能生效。这点对于移动端来说并不是什么问题，毕竟你每次打开移动端基本都是在重新启动 Obsidian。

同步功能并不会让不同名称的配置文件夹相互覆盖。你可以利用这个特点来创建不同的同步配置文件夹。一种常见的用法是，为移动端和桌面端设立不同的同步配置文件夹。

#### 配置文件版本历史

如果配置出现了问题，或是你丢失了部分设置信息，你可以在同步插件的 `配置文件版本历史`中恢复这些设置。

### 第三方同步服务

如果你已经通过 Obsidian 同步服务在某些设备间同步某个库，我们并不推荐你再使用如 Dropbox、Google Drive、OneDrive、iCloud、坚果云之类的第三方同步服务在这些设备间同时同步它。因为这样会造成一些问题，比如冲突、重复文件，更坏的情况下还会使文件损坏。

如果你已经这么做了，那么可能会出现以下情况：

- 如果 Obsidian 同步服务“打败”了第三方同步服务、优先将笔记同步到本地，那么第三方同步服务将无法识别新到的笔记，从而将其视为冲突的文件，产生文件副本。
- 如果第三方同步服务“打败”了 Obsidian 同步服务、优先将笔记同步到本地，Obsidian 同步服务会尝试将新到笔记与旧笔记合并。这可能丢失部分对该笔记的修改（通常会丢失最后修改的几个字符）

因此，不要同时使用 Obsidian 同步服务与第三方同步服务。如果你想通过第三方同步服务来备份笔记，你可以仅在主力笔记设备上开启第三方服务，而不要在其他设备上开启第三方同步服务。即在主力设备上用第三方同步服务备份笔记，用 Obsidian 同步服务将笔记同步至其他设备。这样就能避免第三方同步服务与 Obsidian 同步服务的竞争。

### 疑问与解答

##### 什么是端到端加密？

端到端加密指的是当数据离开你的设备后就立即被算法加密，当且仅当数据回到你的设备时才能通过你的密钥进行解密的模式。

因此，我们没有读取你笔记数据的能力，网络供应商等潜在的窃听者也不会存在。

除非服务器数据完全泄露（这种事件发生的概率几乎为 0），否则你的数据将一直处于加密状态，没有人能在不知道你密钥的情况下解密你的数据。

##### 我可以拥有几个远程库？

每个购买了 Obsidian 同步服务的账号最多能拥有 5 个远程库。

##### 版本历史将保存多久？

版本历史最多可以保存一年。

##### 远程库的容量是多大？

目前，每个远程库的容量限制为 10 GB（这包括版本历史占用的容量）

##### 我的数据是在本地加密吗？

并不是，笔记数据并不会在本地加密。所以如果你想在本地对笔记进行加密以防他人在使用你的设备时发现你的隐私，你可以使用硬盘加密工具。

##### 订阅到期后我的笔记数据会在服务器保存多久？

订阅到期后，笔记数据（包括版本历史）会在服务器上保留一个月。

只要你在一个月内及时续订，这不会对你的使用有任何影响。

##### 我是否能将 Obsidian 同步服务作为笔记数据的备份手段？

我们设计同步服务时，更将其视为多设备间数据同步的解决方案，而非备份的解决方案。

但因为版本历史功能的存在，同步服务确实能提供一些备份的功能。但是，我们仍推荐你使用专业的备份解决方案。

另外，同步服务仍处于测试阶段。因此我们也强烈推荐你通过其他方案备份笔记数据，以防同步服务的 bug 或小故障。

##### 我是否应该使用自定义加密功能？

如果你需要最高级别的安全与隐私保障，那么我们推荐你使用自定义加密功能。自定义加密密码可以保证任何人都不能读取你的笔记数据。

当然，使用我们的内置方案确实更方便，并且你也不会因为忘记或丢失密码而导致数据永远不可用。

无论你是否启用自定义加密功能，本地数据都不会受到影响。你可以通过合适的方式备份本地的笔记数据。

##### 端到端加密很安全吗？

我们使用工业级的 AES-256 算法来加密你的数据。AES-256 是军用级别的加密方案，其已被在线支付业务广泛使用。

如果你对加密算法感兴趣，这是同步服务加密方法的细节信息：

- Key derivation function used: scrypt with salt
- Encryption algorithm used: AES-256 using GCM

##### `vault limit exceeded` 错误是什么意思？

每个远程库的最大容量为 10 GB。当你的库超过这个大小时，Obsidian 就会提示这个错误。需要注意的是，库中的附件以及版本历史一样会占用库容量。所以，即便库中笔记少于 10 GB，远程库也还是有超限的可能。

当你看到这个错误提示后，Obsidian 将帮助你查找库中最大的文件，从而减小远程库的体积。你只需到同步插件的设置中寻找 "库大小超标" 选项即可。
